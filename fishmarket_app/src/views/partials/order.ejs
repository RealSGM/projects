<div class="order-card">

    <div class="order-header toggle-header" onclick="toggleOrder(this)">
        <div>
            <h4>Order #<%= order.orderId %></h4>
            <p class="order-date"><%= order.date %></p>
        </div>
        <div class="order-total">£<%= order.total.toFixed(2) %></div>
        <i class="fa-solid fa-chevron-down arrow"></i>
    </div>

    <div class="order-content">
        <% order.products.forEach(item => {
            const product = products.find(p => p.id === item.id);
        %>
        <div class="product-row-extended">
            <img src="<%= product.image %>" class="product-thumb">

            <div class="product-details">
                <span class="product-name"><%= product.name %></span>
                <span class="product-price">£<%= product.price.toFixed(2) %></span>
            </div>

            <div class="product-meta">
                <span class="qty">x<%= item.quantity %></span>
                <span class="subtotal">£<%= (product.price * item.quantity).toFixed(2) %></span>
            </div>
        </div>
        <% }) %>
    </div>

    <script>
        function toggleOrder(header) {
            const card = header.parentElement;
            const content = card.querySelector(".order-content");
            const arrow = header.querySelector(".arrow");
        
            content.classList.toggle("open");
            arrow.classList.toggle("open");
        
            if (content.classList.contains("open")) {
                content.style.maxHeight = content.scrollHeight + "px";
            } else {
                content.style.maxHeight = "0px";
            }
        }
    </script>
</div>
